<html>

<head>
<title>Методические указания к выполнению курсовых работ по курсу "Системное програмирование"</title>
</head>

<body bgcolor=#F5DEB3 leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0" marginwidth="0">
<center>
<table border="3">
<tr>
<td width="700"> <font color="#0000FF">
<h2><center>12.Почтовые ящики (MailSlots).</center></h2>
<p align="justify">&nbsp&nbsp&nbspРазработать программу-сервер и программу клиент для 
обмена сообщениями между двумя компьютерами при помощи почтовых слотов. 
Клиент посылает серверу запрос на выполнение одной из команд: DIR, MKDIR, CD. 
Сервер принимает команду, выполняет ее, а результат отправляет клиенту.</p>
</td>
<tr>
<td bgcolor="#FFFAFA" width="700"><center><h3><font color="#00008B"></font></h3></center>   

<p align="justify">&nbsp&nbsp&nbspПочтовые слоты (mailslots) — это механизм односторонней 
пересылки данных между процессами по сети. Почтовые слоты по своим свойствам отличаются от 
каналов.<br> 

&nbsp&nbsp&nbspЧерез почтовые слоты можно посылать только не слишком важные данные, 
потеря или запаздывание которых не приносит особого вреда.<br>
 
&nbsp&nbsp&nbspНапример, их можно использовать для циркулярной рассылки кодов обновления 
состояния какого-нибудь процесса через каждые пять минут. Если эти данные однажды случайно 
не попадут к одному из пользователей, ничего страшного не случится, а вот в случае посылки 
таких данных, как учетные транзакции, это совершенно неприемлемо.<br>

&nbsp&nbsp&nbspЛюбой процесс, который создает почтовый слот для приема данных, называется 
сервером слота. Даже если само по себе приложение является клиентом и получает данные от 
приложения-сервера, по отношению к созданному почтовому слоту оно представляет собой сервер. 

&nbsp&nbsp&nbspДля данного слота любой компьютер сети может быть сервером, но читать из 
слота данные (или обращаться к нему другими способами, т.е. через наследование) может 
только процесс, который его создал.<br>

&nbsp&nbsp&nbspВсякий процесс, которому известно имя слота, может посылать ему данные. 
Процессы, которые посылают данные на почтовый слот, называются клиентами слота.<br>

&nbsp&nbsp&nbspДля создания слота в приложениях используется функция CreateMailSlot. 
Ее первый параметр — это указатель на ASCII-строку, содержащую имя создаваемого почтового 
слота. Слоты создаются только на локальном компьютере, поэтому полное имя слота выглядит 
следующим образом:<br><br>

\\ .\mailslot\[Путь]Имя.<br><br>

&nbsp&nbsp&nbspВ именах почтовых слотов поддерживается псевдокаталоговая структура. 
Для лучшей организации почтовых слотов в их именах можно указывать пути в каталогах.<br>

&nbsp&nbsp&nbspФункция CreateMailslot также принимает в качестве параметров максимальный 
размер сообщений, время задержки для операций чтения и необязательную защитную структуру. 
Вместо значения задержки можно указать константу для режима для блокирования операций 
чтения на слоте до получения сообщения без ограничения времени.<br>

&nbsp&nbsp&nbspЕсли функция CreateMailslot завершается успешно, она возвращает ключ для 
нового слота.<br>
 
&nbsp&nbsp&nbspДля изменения времени задержки операций чтения после создания слота 
используется функция SetMailslot. Кроме того, для получения такой информации о слоте, 
как максимальный размер сообщения, размер следующего сообщения в очереди и количество 
сообщений в очереди, можно использовать функцию GetMailslotInfo.<br>

&nbsp&nbsp&nbspДля чтения из слота используется функция ReadFile, которая завершает свою 
работу после получения сообщения, независимо от того, сколько байтов необходимо прочитать.<br>

&nbsp&nbsp&nbspКроме того, с помощью функции GetMailslotInfo можно узнать количество 
сообщений, ожидающих в очереди слота, и размер следующего сообщения.<br>

&nbsp&nbsp&nbspДля записи сообщения в слот вначале необходимо открыть его ключ с помощью 
функции CreateFile, а затем воспользоваться функцией WriteFile для посылки сообщения. 
Ключ слота закрывается функцией CloseHandle. При вызове CreateFile необходимо указать имя 
слота, которому посылается сообщение. Указанное имя допускает циркулярную рассылку данных 
всем слотам с такими же именами на компьютерах домена.<br>

&nbsp&nbsp&nbspДля локального компьютера имя слота выглядит следующим образом:<br><br>
	
\\ .\mailslot\[Путь]Имя<br><br>

&nbsp&nbsp&nbspДля удаленного компьютера имя слота имеет следующий вид:<br><br>
	
\\ИмяУдаленногоКомпьютера\mailslot\[Путь]Имя<br><br>

&nbsp&nbsp&nbspДля рассылки сообщения всем слотам с одинаковыми именами на компьютерах 
домена необходимо указать следующее имя:<br><br>

\\ИмяДомена\mailslot\[Путь]Имя<br><br>

&nbsp&nbsp&nbspДля рассылки сообщения всем компьютерам в домене более высокого 
иерархического уровня используется следующее имя:<br><br>

\\*\mailslot\[Путь]Имя<br><br>

&nbsp&nbsp&nbspПосле успешного завершения функции CreateFile ключ, который она возвращает, 
можно использовать в функции WriteFile для посылки сообщений на слот.<br>

&nbsp&nbsp&nbspПо окончании работы с почтовым слотом его необходимо закрыть вызовом функции 
CloseHandle для освобождения ассоциированных с ним системных ресурсов.<br>
 
&nbsp&nbsp&nbspПо завершении процесса все ключи слотов, ассоциированных с процессом, 
закрываются автоматически. После их закрытия почтовый слот уничтожается, а все данные в 
его буфере теряются.</p>


</td></tr>
</table>
</center>
<br><br><font color="#0000FF"><a href="index.html">Вернуться к списку тем.</a></font>

</body>


</html>