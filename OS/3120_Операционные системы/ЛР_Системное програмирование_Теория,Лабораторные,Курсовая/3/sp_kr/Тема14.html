<html>

<head>
<title>Методические указания к выполнению курсовых работ по курсу "Системное програмирование"</title>
</head>

<body bgcolor=#F5DEB3 leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0" marginwidth="0">
<center>
<table border="3">
<tr>
<td width="700"> <font color="#0000FF">
<h2><center>14.Получение сведений о системе (System Informatio).</center></h2>
<p align="justify">&nbsp&nbsp&nbspРазработать программу, которая отображает следующие 
сведения о конфигурации компьютера.</p>
</td>
<tr>
<td bgcolor="#FFFAFA" width="700"><center><h3><font color="#00008B"></font></h3></center>   

<p align="justify">&nbsp&nbsp&nbspПрограмма должна отображать основные сведения о конфигурации компьютера по следующим позициям:</p>
<ul>
1.	Процессор<br>
2.	Память<br>
3.	Видео<br>
4.	Накопители<br>
5.	Устройства ввода<br>
6.	Сетевая информация<br>
7.	Операционная система<br>
8.	Системная информация</ul>

<p align="justify">&nbsp&nbsp&nbspПроцессор – информация о названии процессора, его типе, тактовой частоте, поддерживаемых инструкциях.<br>
&nbsp&nbsp&nbspПамять – информация о занятости памяти, полном и доступном объеме физической и виртуальной памяти.<br>
&nbsp&nbsp&nbspВидео – информация о типе и драйвере видеокарты, типе монитора, разрешении экрана, цветовой палитре, частоте обновления.<br>
&nbsp&nbsp&nbspНакопители – информация о всех присутствующих накопителях (жестких дисках, CDROM, и т.д.).<br>
&nbsp&nbsp&nbspУстройства ввода – информация об устройствах ввода (клавиатура, мышь).<br>
&nbsp&nbsp&nbspСетевая информация – информация о сетевом имени компьютера и его IP-адресе.<br>
&nbsp&nbsp&nbspОперационная система – информация о типе операционной системы установленной на компьютере.<br>
&nbsp&nbsp&nbspСистемная информация – информация об имени компьютера, текущем пользователе, системном и Windows каталогах.<br>
&nbsp&nbsp&nbspВнешний вид программы может быть представлен следующим образом:<br>
<center><img src="рис.14.1.JPG"><br>Рис 14.1 Внешний вид программы.</center>
<p align="justify">&nbsp&nbsp&nbspВ левой части главного окна находятся кнопки. Надписи на 
кнопках указывают на ту информацию, которая будет выведена при нажатии на кнопку. В нижнем 
левом углу находится кнопка выход. Нажатие на нее приводит к завершению программы.<br> 
&nbsp&nbsp&nbspВ правой части главного окна находится область, куда выводится вся информация. Текст из 
этой области может быть скопирован в буфет обмена. При необходимости, в правой стороне этой 
области автоматически появляется полоса прокрутки.</p>

<p align="justify">&nbsp&nbsp&nbspИнтерфейс программы написан с использованием Win32 API. 
Рассмотрим основные функции:<br> 

&nbsp&nbsp&nbspФункция <b>DlgProc</b> - функция инициализации окна.Сообщение WM_INITDIALOG приводит к 
инициализации диалогового окна на котором размещены все необходимые элементы. Сообщение 
WM_COMMAND посылается оконной процедуре всеми стандартными элементами (в нашем случае – 
кнопками). В элементе wParam посылаемых сообщений хранится информация достаточная для того, 
чтобы программа смогла определить, какие действия ей необходимо выполнить при нажатии той 
или иной кнопки.<br>

&nbsp&nbsp&nbspФункция <b>GetSysInfo</b> - предназначена для получения системной информации,
а именно: имени компьютера,  имени текущего пользователя, системного и Windows каталога.<br>
&nbsp&nbsp&nbspВсю эту информацию возвращают стандартные функции Win32:</p>
<ul>GetComputerName – функция возвращающая имя компьютера.<br>
    GetUserName – функция возвращающая имя текущего пользователя.<br>
    GetSystemDirectory – функция возвращающая имя системного каталога.<br>
    GetWindowsDirectory – функция возвращающая имя каталога в который установлена операционная система.</ul>
<p align="justify">&nbsp&nbsp&nbspВся информация сохраняется в строке Info. В дальнейшем стандартная функция 
SendMessage посылает элементу Edit (данный элемент непосредственно выводит информацию в 
окне) сообщение WM_SETTEXT и с ним передает строку Info.<br>

&nbsp&nbsp&nbspФункция <b>GetCPUInfo</b> - служит для получения информации о процессоре, а 
именно: типе процессора, его тактовой частоты, поддерживаемых инструкциях.
Информацию об имени, типе процессора, а также его тактовой частоте программа берет из 
реестра Windows. Для этого при помощи Win32 функции (в дальнейшем все стандартные Win32 
функции будут помечены знаком ) RegOpenKeyEx*. Далее при помощи функции RegQueryValueEx* 
проводится выборка значений по следующим ключам:</p>
<ul>-	ProcessorNameString – имя процессора<br>
    -	Identifier – тип процессора<br>
    -	~Mhz – частота процессора</ul>
<p align="justify">&nbsp&nbsp&nbspДля определения поддерживаемых инструкций используется функция 
IsProcessorFeaturePresent*. Это логическая функция, которая возвращает значение true при 
поддержки процессором данной инструкции. Используются следующие входные параметры:</p>
<ul>-	PF_MMX_INSTRUCTIONS_AVAILABLE – поддержка инструкций MMX<br>
    -	PF_XMMI_INSTRUCTIONS_AVAILABLE – поддержка инструкций SSE</ul>
<p align="justify">&nbsp&nbsp&nbspКак и в предыдущей функции, вся полученная информация сохраняется в строке 
Info, которая потом передается элементу Edit при помощи функции SendMessage*.<br>

&nbsp&nbsp&nbspФункция <b>GetMemoryStatus</b> - предназначена для получения информации о 
памяти, а именно: занятости памяти, полном и доступном объеме физической и виртуальной 
памяти.
&nbsp&nbsp&nbspВсю эту информацию возвращает функция GlobalMemoryStatus* параметром которой 
является указатель на структуру MEMORYSTATUS. В результате поля структуры будут содержать 
следующую информацию:</p>
<ul>-	dwMemoryLoad – процент занятости физической памяти<br>
    -	dwTotalPhys – полный объем физической памяти (в байтах)<br>
    -	dwAvailPhys – объем доступной физической памяти (в байтах)<br>
    -	dwTotalVirtual – полный объем виртуальной памяти (в байтах)<br>
    -	dwAvailVirtual – доступный объем виртуальной памяти (в байтах)</ul>
<p align="justify">&nbsp&nbsp&nbspКак и в предыдущей функции, вся полученная информация сохраняется в строке 
Info, которая потом передается элементу Edit при помощи функции SendMessage*.<br>
&nbsp&nbsp&nbspФункция <b>GetInpDev</b> - предназначена для получения информации об 
устройствах ввода, а именно о клавиатуре и мыши.Информация о клавиатуре программа получает 
с помощью функции GetKeyboardType*, результатом которой является значение, в зависимости 
от которого определяется тип клавиатуры.Информацию о мыши дает функция GetSystemMetrics () 
с входным параметром SM_CMOUSEBUTTONS. В результате, функция возвращает количество кнопок 
мыши, либо значение 0, если мышь не подключена.<br>
&nbsp&nbsp&nbspBся полученная информация сохраняется в строке Info, которая потом 
передается элементу Edit при помощи функции SendMessage*.<br>
&nbsp&nbsp&nbspФункция <b>GetWinVer</b> - предназначена для получения информации об 
операционной системе установленной на компьютере.Всю необходимую информацию для определения 
операционной системы возвращает функция GetVersionEx*, параметром которой является 
указатель на структуру OSVERSIONINFOEX. В результате поле dwMajorVersion в сочетании с 
полем dwMinorVersion структуры дают возможность определить тип операционной системы. 
Поле wServicePackMajor содержит информацию об установленных Service Pack’ах, а поле 
dwBuildNumber – номер сборки ОС.<br> 
&nbsp&nbsp&nbspВся полученная информация сохраняется в строке Info, которая потом передается
элементу Edit при помощи функции SendMessage*.<br>
&nbsp&nbsp&nbspФункция <b>GetDisks</b> - предназначена для получения информации о всех 
присутствующих в системе накопителях (жестких дисках, CDROM, и т.д.) их типах и т.д.Для 
определения имен дисков используется функция GetLogicalDrives* результатом которой 
является переменная типа DWORD. Далее используя побитовые сдвиги и накладывая битовую 
маску получаем информацию о присутствии того, или иного имени в системе (допустим если 
значение переменной равно 000…00011101, то это означает что в системе присутствуют диски A, 
C, D, E).<br>
&nbsp&nbsp&nbspДля определения типа диска используется функция GetDriveType* входным 
параметром которой является имя диска, а в зависимости от значения, которое вернула функция 
определяется тип диска. Функция GetDriveType* может вернуть следующие значения:</p>
<ul>-	DRIVE_UNKNOWN – тип диска неизвестен<br>
    -	DRIVE_FIXED – жесткий диск<br>
    -	DRIVE_CDROM – CDROM<br>
    -	DRIVE_REMOVABLE – съемный накопитель<br>
    -	DRIVE_REMOTE – съемный диск<br>
    -	DRIVE_RAMDISK – RAM диск</ul>
<p align="justify">&nbsp&nbsp&nbspИнформация об имени диска, типе файловой системы, метке тома определяется 
при помощи функции GetVolumeInformation*, а информация об общем объеме диска, свободном и 
занятом пространстве при помощи GetDiskFreeSpaceEx*. Надо отметить ту особенность, что 
функция  GetDiskFreeSpaceEx* возвращает значения объема диска, свободного и занятого 
пространства в байтах, поэтому для хранения таких больших чисел используется тип __int64 
(64-бита).<br>
&nbsp&nbsp&nbspВся полученная информация сохраняется в строке Info, которая потом 
передается элементу Edit при помощи функции SendMessage*.<br>

&nbsp&nbsp&nbspФункция <b>GetNetInfo</b> - предназначена для получения сетевой информации, 
а именно: сетевого имени компьютера и IP-адреса. Сетевое имя компьютера получаем при 
использовании функции GetHostName*, а IP-адрес при использовании GetHostByName. 
Входным параметром этой функции служит сетевое имя компьютера, а выходным структура 
HOSTENT, которая в списке h_addr_list содержит все IP-адреса компьютера.<br>
&nbsp&nbsp&nbspВся полученная информация сохраняется в строке Info, которая потом 
передается элементу Edit при помощи функции SendMessage*.<br>
&nbsp&nbsp&nbspФункция <b>GetVideo</b> - предназначена для получения информация о типе и 
драйвере видеокарты, типе монитора, разрешении экрана, цветовой палитре, частоте обновления.
Для получения информации о типе видеокарты и монитора использовалась функция 
EnumDisplayDevices*. В результате выполнения функции получаем структуру DISPLAY_DEVICE 
которая, в зависимости от входных параметров, в поле DeviceString содержит тип видеокарты, 
или монитора.Информацию о драйвере видеокарты, разрешении экрана, цветовой гамме и частоте 
обновления дает функция EnumDisplaySettings, в результате выполнения которой получаем 
структуру DEVMODE. Поля данной структуры будут содержать следующую информацию:</p>
<ul>dmDeviceName – информация о драйвере видеокарты<br>
    dmPelsWidth – ширина экрана (в пикселях)<br>
    dmPelsHeight – высота экрана (в пикселях)<br>
    dmBitsPerPel – количество бит цвета на один пиксель<br>
    dmDisplayFrequency – частота обновления (в герцах)</ul>
<p align="justify">&nbsp&nbsp&nbspВся полученная информация сохраняется в строке Info, которая потом 
передается элементу Edit при помощи функции SendMessage*.</p>

</td></tr>
</table>
</center>
<br><br><font color="#0000FF"><a href="index.html">Вернуться к списку тем.</a></font>

</body>


</html>