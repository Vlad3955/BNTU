<html>

<head>
<title>Методические указания к выполнению курсовых работ по курсу "Системное програмирование"</title>
</head>

<body bgcolor=#F5DEB3 leftmargin="0" topmargin="0" rightmargin="0" bottommargin="0" marginwidth="0">
<center>
<table border="3">
<tr>
<td width="700"> <font color="#0000FF">
<h2><center>5.Процессы и потоки (Processes and Threads).</center></h2>
<p align="justify">&nbsp&nbsp&nbspРазработать программу, демонстрирующую механизмы подготовки, 
создания и управления процессами. Программа-оболочка должна уметь создавать процесс, 
ожидать завершения процесса в отдельном потоке, а также завершать запущенные дочерние процессы.
</p>
</td>
<tr>
<td bgcolor="#FFFAFA" width="700"><center><h3><font color="#00008B">Можно предложить следующий вариант реализации.</font></h3></center>   
<p align="justify">&nbsp&nbsp&nbspПрограмма, которая в конце каждой учебной пары (используется расписание занятий БГУИР)
выдает сообщение о том, что время работы за компьютером истекло, и он должен быть выключен. 
Если по истечении 3 минут после выдачи сообщения компьютер продолжает работать, то программа выключает
его принудительно.<br>
&nbsp&nbsp&nbspПри запуске программы в правом нижнем углу появляется значок <img src="рис.5.0.jpg">.
При нажатии левой кнопки мыши по значку открывается главное окно программы (Рис 5.1). 
</p>
<center><img src="рис.5.1.jpg"><br>Рис 5.1 Главное окно программы</center> 
<p align="justify">&nbsp&nbsp&nbspГлавное окно содержит информацию об авторе программы, 
а также показывает время в которое программа выключит компьютер принудительно.
Для того чтобы снова свернуть программу нужно щелкнуть левой кнопкой мыши в любом месте главного окна программы. 
Размеры окна зафиксированы и изменить их с помощью мышки нельзя.
Примечание: данная программа должна быть занесена в «автозагрузку».
При включении компьютера после 18 часов 40 минут – до 7 часов 35 минут программа выдаст следующее сообщение (рис 5.2).
</p>
<center><img src="рис.5.2.jpg"><br>Рис 5.2 Сообщение от программы</center>
<p align="justify">&nbsp&nbsp&nbspПосле нажатия кнопки «ОК» программа завершит свою работу.<br>
&nbsp&nbsp&nbspПри включении компьютера с 7 часов 35 минут до 18 часов 40 минут программа не будет выдавать
сообщений до конца пары. Когда локальное (системное) время будет соответствовать концу пары 
(расписание занятий БГУИР) программа выдаст следующее сообщение (рис 5.3).</p>
<center><img src="рис.5.3.jpg"><br>Рис 5.3 Сообщение от программы по окончании пары</center>
<p align="justify">&nbsp&nbsp&nbspЕсли по истечении 3 минут после появления этого сообщения 
компьютер не будет выключен, то программа выключит его самостоятельно.<br>
&nbsp&nbsp&nbspПримечание: выключение компьютера программой может быть не осуществлено 
из-за какой-либо ошибки или сбоя.  В этом случае программа выдаст сообщение (рис 5.4).</p>
<center><img src="рис.5.4.jpg"><br>Рис 5.4 Сообщение от программы при ошибке</center>
<p align="justify">&nbsp&nbsp&nbspФункции и флаги используемые для выключения компьютера:<br>
&nbsp&nbsp&nbspФункция ExitWindowsEx  закрывает систему, или закрывает и повторно перезапускает систему. 
Она посылает сообщение  WM_QUERYENDSESSION всем приложениям, чтобы определить, могут ли они быть закончены.<br>
&nbsp&nbsp&nbspEWX_POWEROFF - Закрывает систему и выключает питание. Система должна поддержать особенность " power-off feature ". <br>
&nbsp&nbsp&nbspWindows NT/2000 или позже: процесс запроса должен иметь SE_SHUTDOWN_NAME привилегию. <br>
&nbsp&nbsp&nbspФункция LookupPrivilegeValue восстанавливает в локальном масштабе уникальный идентификатор 
(LUID) используемый на указанной системе, чтобы представить указанное название(имя) привилегии.<br>
&nbsp&nbsp&nbspФункция OpenProcessToken открывает символ доступа, связанный с процессом.<br>
&nbsp&nbsp&nbspФункция AdjustTokenPrivileges позволяет или запрещает привилегии в указанном символе доступа. Предоставление возможности или выведение из строя привилегий в символе доступа требует TOKEN_ADJUST_PRIVILEGES доступа.<br>
&nbsp&nbsp&nbspСтруктура TOKEN_PRIVILEGES содержит информацию относительно набора привилегий для символа доступа.</p>

</td></tr>
</table>
</center>
<br><br><font color="#0000FF"><a href="index.html">Вернуться к списку тем.</a></font>

</body>


</html>